# setup for microcontroller

#. compile this with sh/compile
#. will compile to agent.cfg, devices.xml, pipeline-overrides.yaml, topology.dot?
#. include in sh/pipeline steps? ie always compile this file (or if changed)

# meta:
#   foo: bar

devices:
  - id: m1
    name: micro1 # this must match name in agent.cfg and devices.xml
    model: ladder99/glimpse
    # specify sources for dataitem values
    #. eg could have multiple thermometers for a machine, or doors?
    #. be careful with multiple sources - don't want to clobber dataitems.
    sources:
      - model: ladder99/glimpse
        driver: micro # adapter plugin - manages protocol and payload

    #. this should be server, not destinations - for agent to connect to
    destinations: # where to post output - just uses first output for now
      - protocol: shdr
        host: adapter
        port: 7878
#
#. idea for templates - define macros/fns/templates, then instantiate them?

# templates:
#   - camera(id,name,sourcePort,destPort):
#       id: $id
#       name: $name
#       model: ladder99/camera
#       sources:
#         - model: ladder99/camera
#           driver: http-json
#           protocol: http
#           host: play
#           port: $sourcePort
#       destinations:
#         - protocol: shdr
#           host: adapter
#           port: $destPort

# devices:
#   - camera(d1,camera1,8080,7878)
#   - camera(d2,camera2,8081,7879)

# devices:
#   - id: d1
#     name: camera1 # this must match name in agent.cfg and devices.xml
#     model: ladder99/camera
#     #. do we really want/need ability to have >1 source per device?
#     # won't it lead to conflicts with dataitem ids, eg connection/device-availability?
#     #. just have single source and destination for now?
#     sources:
#       - model: ladder99/camera
#         driver: http-json # type of adapter plugin - manages protocol and payload
#         protocol: http
#         host: play
#         port: 8080
#     destinations: # where to post output - just handles one output for now
#       - protocol: shdr
#         host: adapter
#         port: 7878

#   - id: d2
#     name: camera2 #. is this used yet? check code
#     model: ladder99/camera
#     sources:
#       - model: ladder99/camera
#         driver: http-json # type of adapter plugin - manages protocol and payload
#         protocol: http
#         host: play
#         port: 8081
#     destinations: # where to post output - just handles one output for now
#       - protocol: shdr
#         host: adapter
#         port: 7879

