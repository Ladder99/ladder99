# outputs

# these outputs are placed in the module.xml tree and define the
# shdr strings that are calculated from the cache and sent to the agent.

# this file is processed by adapter/index.js

# the item's id in the xml and the shdr key is `${deviceId}-${key}`
# the shdr value is defined with the item value code.

# value is javascript, evaluated by the cache in calculating the shdr output.
# <foo> is a cache lookup, shorthand for cache.get('${deviceId}-foo')

# note: cache keys are ARBITRARY,
# ie not necessarily the same as dataitem id OR name.
# eg <status_step> references the cache value at 'kl1-status_step',
# which was set in inputs.yaml, while the output key here is 'step',
# which becomes eg 'kl1-step' for the SHDR id.

# the idea is to keep the SHDR id's as short as possible, to reduce network bandwidth,
# while the dataitem name can be more descriptive.

# note: category is used to determine shdr representation.
# only need to specify category if CONDITION.
# only need to specify type if is MESSAGE.
# see end of services/adapter/src/cache.js for details.

# note: as a shortcut, can just specify the key -
# value will be inferred to be <key>.

outputs:
  # ------------------------------------------------------------------
  # device
  # ------------------------------------------------------------------

  # displayed in Devices and Graphs pages as ON/OFF.
  # this had been just using <controller>, but decided to split the controller out
  # to a separate device, and use dxm && controller here. 2022-07-19
  # <controller> comes from the controller birth/death messages
  # <dxm> comes from io.a5===128
  - key: avail # availability
    value: types.AVAILABILITY[<dxm> && <controller>]

  #?
  # # displayed in Graphs page as Machine Status ON/OFF
  # - key: ctl-avail # controller/availability
  #   value: types.AVAILABILITY[<dxm> && <controller>]

  # current job number
  - key: job # processes/job/process_aggregate_id/order_number

  # current job current part count
  - key: pcjob # processes/job/part_count-all
    value: <part_count>

  # current lifetime part count
  # - key: pclife # processes/life/part_count-all
  #   value: <pclife> + <delta pcjob>

  # shift start/stop
  - key: start # processes/shift/process_time-start
  - key: complete # processes/shift/process_time-complete

  # motor
  - key: xtemp # axes/x/motor/temperature
  - key: xvelx
  - key: xvelz
  - key: xaccx
  - key: xaccz

  # pressure
  - key: sp
